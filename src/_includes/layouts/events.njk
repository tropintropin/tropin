{% extends "layouts/base.njk" %}

{% block content %}
<div id="progress-bar"></div>

<h1 class="page-title">События</h1>

<small>
<p class="page-description">
    Здесь собраны мероприятия, в которых я участвую или которые организую. В
    основном это лекции и экскурсии.
</p>

<aside class="events-toc">
    <nav>
        <ul>
            {% if collections.events | length > 0 %}
            <li><a href="#upcoming">Предстоящие события</a></li>
            {% endif %}
            {% if collections.pastEvents | length > 0 %}
            <li><a href="#archive">Архив событий</a></li>
            {% endif %}
        </ul>
    </nav>
</aside>

<p>
    Вы можете добавить календарь событий к себе на устройство по
    <a href="{{ site.calendar.url }}" title="{{ site.calendar.title }}">ссылке</a
    >. Обратите внимание: это статический файл ICS, новые события не будут
    добавляться автоматически — для обновлений нужно скачать файл снова.
</p>

<p>
    Если хотите подписаться на обновления автоматически, вставьте этот URL в
    Google Calendar:
</p>

<div class="code-frame">
{% highlight "http" %}
{{ site.url + site.calendar.url }}
{% endhighlight %}
</div>
</small>

{% if collections.events | length == 0 %}
    <p>Нет предстоящих событий.</p>
{% else %}
    <h2 id="upcoming">Предстоящие события</h2>
    <p class="events-count">Всего: {{ collections.events | length }}</p>

    <div class="events-posts-list" data-pagefind-ignore="all">
        {% set currentYear = "" %}
        {% for post in collections.events %}
        {% set postYear = post.date | date("yyyy") %}
        {% if postYear != currentYear %}
            <h3 class="blog-year">{{ postYear }}</h3>
            {% set currentYear = postYear %}
        {% endif %}
        {% include "partials/card.njk" %}
        {% endfor %}
    </div>
{% endif %}

{% if collections.pastEvents | length > 0 %}
    <h2 id="archive">Архив событий</h2>
    <p class="events-count">Всего: {{ collections.pastEvents | length }}</p>

    <div class="events-posts-list">
        {% set currentYear = "" %}
        {% for post in collections.pastEvents %}
        {% set postYear = post.date | date("yyyy") %}
        {% if postYear != currentYear %}
            <h3 class="blog-year">{{ postYear }}</h3>
            {% set currentYear = postYear %}
        {% endif %}
        {% include "partials/card.njk" %}
        {% endfor %}
    </div>
{% endif %}
{% endblock %}
